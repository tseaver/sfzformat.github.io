<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">

		<title>Envelope Generators - SFZ Format</title>

		<meta name="author" content="Karoryfer Samples and SFZ Format Team">
		<meta name="web-author" content="RedTide and SFZ Format Team">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Atom Feeds -->
		<link href="/atom.xml" rel="alternate" type="application/atom+xml" />

		<!-- Favicon Generator Icons -->
		<link rel="apple-touch-icon" sizes="152x152" href="/assets/ico/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/assets/ico/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/assets/ico/favicon-16x16.png">
		<link rel="manifest" href="/assets/ico/site.webmanifest">
		<link rel="mask-icon" href="/assets/ico/safari-pinned-tab.svg" color="#5bbad5">
		<link rel="shortcut icon" href="/assets/ico/favicon.ico">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="msapplication-config" content="/assets/ico/browserconfig.xml">
		<meta name="theme-color" content="#ffffff">

		<!-- Stylesheets -->
		<link href="/assets/css/style.min.css" rel="stylesheet" media="screen">
		<link rel="stylesheet" type="text/css" href="/assets/css/prettify.css">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css" rel="stylesheet">

		<!-- Font Awesome Icons -->
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/solid.js"       integrity="sha384-Mf3ap7OwO+bjTkzM1RsrothLh38uKXvMWJ2TQPXGHqZcqfeI/cyCV+sfV0IDnBDq" crossorigin="anonymous"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/brands.js"      integrity="sha384-b2GpqFrJizV0BUEdbrITdOA5HnxnlrErt7MlEERWd6NSJ32rHeibEvyyCuA13OAS" crossorigin="anonymous"></script>
		<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/fontawesome.js" integrity="sha384-EYYaHDhIRoBhd/Ir/1fPnxg9rZLk/55lKtlNT5KrIcONoCS2kjf7ZWzMoCLLACeo" crossorigin="anonymous"></script>

	</head>

	<body>

		<button onclick="topFunction()" id="scrollButton" title="Go to top">Top</button>
		<a href="#content" class="sr-only">Skip to content</a>
		<div class="container">

			<nav class="navbar navbar-expand-lg navbar-dark" style="background-color:#222">
				<a class="navbar-brand" href="/">
					<img src="/assets/img/logo.png"
					width="120" height="30" class="d-inline-block align-top" alt=""></a>

				<button class="navbar-toggler" type="button" data-toggle="collapse"
					data-target="#navbarContent" aria-controls="navbarContent"
					aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navbarContent">
					<ul class="navbar-nav mr-auto mt-2 mt-lg-0">


	
		
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="navbarSyntax"
								data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false"> Syntax</a>
							<div class="dropdown-menu" aria-labelledby="navbarSyntax">
		
			
								<a class="dropdown-item"
									href="/headers/">Headers</a>
			
		
			
								<a class="dropdown-item"
									href="/opcodes/">Opcodes</a>
			
		
			
								<div class="dropdown-divider"></div>
			
		
			
								<a class="dropdown-item"
									href="/modulations/">Modulations</a>
			
		
			
								<a class="dropdown-item"
									href="/modulations/envelope_generators">Envelope Generators</a>
			
		
			
								<a class="dropdown-item"
									href="/modulations/lfo">LFO</a>
			
		
			
								<div class="dropdown-divider"></div>
			
		
			
								<a class="dropdown-item"
									href="/extensions/midi_ccs">Extended MIDI CCs</a>
			
		
			
								<div class="dropdown-divider"></div>
			
		
			
								<a class="dropdown-item"
									href="/misc/categories">Types & Categories</a>
			
		
							</div>
	
						</li>

	
		
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="navbarSoftware"
								data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false"> Software</a>
							<div class="dropdown-menu" aria-labelledby="navbarSoftware">
		
			
								<a class="dropdown-item"
									href="https://sfzinstruments.github.io">Instruments</a>
			
		
			
								<a class="dropdown-item"
									href="/software/players">Players</a>
			
		
			
								<a class="dropdown-item"
									href="/software/tools">Tools</a>
			
		
							</div>
	
						</li>

	
		
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="navbarTutorials"
								data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false"> Tutorials</a>
							<div class="dropdown-menu" aria-labelledby="navbarTutorials">
		
			
								<a class="dropdown-item"
									href="/tutorials/basics">Basics</a>
			
		
			
								<div class="dropdown-divider"></div>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/basic_sfz_file">Basic / Template</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/sustained_note_basics">Sustained Note Basics</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/vibrato">Vibrato</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/legato">Legato</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/unison">Unison</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/subtractive_synths">Subtractive Synthesizers</a>
			
		
			
								<div class="dropdown-divider"></div>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/drum_basics">Drum Basics</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/cymbal_muting">Cymbal Muting</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/brush_stirs">Brush Stirs</a>
			
		
			
								<div class="dropdown-divider"></div>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/sfz1_modulations">SFZ 1 Modulations</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/sfz2_modulations">SFZ 2 Modulations</a>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/lfo">Pitch LFO Examples</a>
			
		
			
								<div class="dropdown-divider"></div>
			
		
			
								<a class="dropdown-item"
									href="/tutorials/videos">Video Tutorials</a>
			
		
							</div>
	
						</li>

	
		
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="navbarDocs"
								data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false"> Docs</a>
							<div class="dropdown-menu" aria-labelledby="navbarDocs">
		
			
								<a class="dropdown-item"
									href="/docs/website-development-reference">Website Development Reference</a>
			
		
			
								<a class="dropdown-item"
									href="/docs/jekyll-windows-setup">Jekyll Setup on Windows</a>
			
		
			
								<a class="dropdown-item"
									href="/docs/adding-multimedia-content">Add Multimedia Content</a>
			
		
							</div>
	
						</li>

	
						<li class="nav-item">
							<a class="nav-link"
								href="/news"> News</a>
	
						</li>

						<li class="nav-item">
							<a class="nav-link"
								href="/search/">
								Search</a>
						</li>
					</ul>
				</div>
			</nav>

			<div class="row mt-4" id="content">
				<div class="col-md-9">
					<article><h1>Envelope Generators</h1><p>Envelope generators (EGs) are used to control the profile of the volume, filter,
 pitch, or other parameter, based on the timing of the key press and release
(including sustain/sostenudo pedal release.)  These are often called “ADSRs”,
after the four parameters (Attack, Decay, Sustain, Release) that were used
to control envelopes in early synthesizers (and many current ones as well.)</p>

<p>See <a href="tutorials/sfz1_modulations">SFZ1 Modulations</a> to see examples of how these can be applied.</p>

<p>SFZ has two types of EGs: SF1 and SF2.</p>
      <h2 id="sf1-dsahdsr">
        
        
          SF1: DSAHDSR <a href="#sf1-dsahdsr" class="toc-anchor">#</a>
        
        
      </h2>

<p>SF1 envelopes are sometimes called DSAHDSR after the 7 controls of the envelope,
which are applied in the order given below.  An EG can control a variet of parameters,
but to help understand, you can imagine it controlling the volume, in which case you
can substitute “volume” for “EG” below.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Suffix</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Delay time (s)</td>
      <td>_delay</td>
      <td>time to wait after key is depressed until the EG starts</td>
    </tr>
    <tr>
      <td>Start <strong>level</strong> (%)</td>
      <td>_start</td>
      <td>level at which to start</td>
    </tr>
    <tr>
      <td>Attack time (s)</td>
      <td>_attack</td>
      <td>time from note start (at start level) to 100% level</td>
    </tr>
    <tr>
      <td>Hold time (s)</td>
      <td>_hold</td>
      <td>time the volume is held at 100% level</td>
    </tr>
    <tr>
      <td>Decay time* (s)</td>
      <td>_decay</td>
      <td>time* for the volume to decrease from 100% to the sustain level</td>
    </tr>
    <tr>
      <td>Sustain <strong>level</strong> (%)</td>
      <td>_sustain</td>
      <td>the % level at which the EG remains while the key is down or the sustain pedal is down</td>
    </tr>
    <tr>
      <td>Release time*</td>
      <td>_release</td>
      <td>time* for the EG to decrease to zero. This begins when both key and sustain pedal are released, even if the prior stages have not completed.</td>
    </tr>
  </tbody>
</table>

<p>We’ll get to the asterisks in a moment.  Here is a screenshot of an audio file created using Sforzando,
showing the ampeg_envelope shape and its stages.  Note that this image assumes the Start level is 0.
If it were nonzero, the tip of the left-pointing arrow would look chopped off vertically.</p>

<p><img src="/assets/img/ampeg_env.jpg" class="img-fluid" alt="DAHDSR envelope shape image" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://media.discordapp.net/attachments/573505647841116161/720408000828932196/EnvelopeGraphic.png
</code></pre></div></div>

<p>Here’s a play-by-play explanation, when using the EG for volume (ampeg_xxx).
When the key is depressed, Delay time elapses and then the note starts (at Start level, which above is
the default of 0.)
The volume increases (at a constant dB/sec rate) for the Attack time and then reaches the peak level
for that note (which is controlled by the velocity and possibly other parameters.)
The volume stays at that level for the Hold time, after which it falls off for the Decay time
until it reaches the Sustain level.  It remains at that level until the key and sustain pedal
are both released, when it takes the Release time to fall off to silence.</p>

<p>Now the asterisks.</p>

<ul>
  <li>Decay time is actually a constant decay <strong>rate</strong> that is specified as the time for the EG to go from 100% to <strong>0%</strong>.  However, this can be changed by setting xxx_decay_zero=0 to instead mean to decay from 100% to <strong>sustain level</strong> in the given time, from the actual sustain level.</li>
  <li>Release time is actually a constant decay <strong>rate</strong> that is specified as the time for the EG to go from the <strong>sustain level</strong> to zero.  However, this can be changed setting by xxx_release_zero=1 to instead mean to decay from <strong>100%</strong> to zero in the given time.</li>
  <li>When using an amp enevlope generator, “0%” means “silence” but it’s actually interpreted as -90dBFS for Aria, or -80dBFS for original sfz.  This adjustment is needed because volume is contolled in dB, and silence in dB is negative infinity, which complicates the math.</li>
  <li>Yeah, it’s confusing.</li>
</ul>

<p>Note that when using an envelope generator to control volume, it is usually not necessary to adjust release or decay times based on velocity: that will happen naturally.  That is, if I configure <code class="language-plaintext highlighter-rouge">ampeg_release=1</code> and play a very loud note, that note will decay with a rate so that one second later it will be about 90 dB quieter than when it started.  If I play a very soft note, that note will also decay with the same rate, so that 1 second later it will be 90 dB quieter when it started.  That’s pretty close to how most natural instruments behave.</p>

<p>Another note when using an envelope to control volume: if you’re playing a sample that already has a natural envelope, such as the pluck of a harp string, you normally don’t have to configure the envelope because it’s already in the sample, which has a natural attack and decay.  However, you’ll still probably want to configure a release, so that if the key is released before the sample is finished, it doesn’t end abruptly.  With most natural instruments, this release rate varies with pitch, but not velocity.</p>
    
      <h2 id="sf2">
        
        
          SF2 <a href="#sf2" class="toc-anchor">#</a>
        
        
      </h2>

<p>The SF2 standard has a more flexible generator that can be used in addition to
the above.  This is briefly described in <a href="/tutorials/sfz2_modulations#envelopes">SF2 Modulations:Envelopes</a>.</p>
					</article>
				</div>
				<div class="col-md-3">
					<aside>

	
						<div class="card border-dark mb-3">
							<div class="card-header text-light"
								style="background-color:#222">
								<i class="fas fa-eye"
									aria-hidden="true"></i>
								Follow us
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
	<li class="nav-item">
										<a class="nav-link" href="https://discord.gg/t7nrZ6d"
											title="Discord Chat" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-discord fa-fw"
										aria-hidden="true"></i>
										Discord Chat</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://kiwiirc.com/nextclient/#irc://irc.freenode.net:+6697/#sfzformat"
											title="Internet Relay Chat" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-hashtag fa-fw"
										aria-hidden="true"></i>
										IRC</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfzformat/"
											title="GitHub Organization" style="padding: 0.35rem 0.25rem">
										<i class="fab fa-github fa-fw"
										aria-hidden="true"></i>
										GitHub Organization</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="/atom.xml"
											title="News Atom Feed" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-rss fa-fw"
										aria-hidden="true"></i>
										News Atom Feed</a>
									</li>
	
								</ul>
							</div>
						</div>

						<div class="card border-dark mb-3">
							<div class="card-header text-light"
								style="background-color:#222">
								<i class="fas fa-link"
									aria-hidden="true"></i>
								Quick links
							</div>
							<div class="card-body" style="padding: 0.5rem">
								<ul class="nav nav-pills flex-column">
	<li class="nav-item">
										<a class="nav-link" href="/legacy"
											title="Old rgc:audio SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-book fa-fw"
										aria-hidden="true"></i>
										Old rgc:audio SFZ page</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="http://www.drealm.info/sfz/"
											title="Peter L. Jones' SFZ page" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-book fa-fw"
										aria-hidden="true"></i>
										Peter L. Jones' SFZ page</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://www.kvraudio.com/forum/viewtopic.php?f=42&t=508861"
											title="KVR Forum SFZ post" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-users fa-fw"
										aria-hidden="true"></i>
										KVR Forum SFZ post</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://www.plogue.com/plgfrms/viewforum.php?f=14"
											title="Plogue Forum" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-users fa-fw"
										aria-hidden="true"></i>
										Plogue Forum</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://sfzinstruments.github.io/"
											title="Free SFZ Instruments" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-download fa-fw"
										aria-hidden="true"></i>
										Free SFZ Instruments</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/tests/"
											title="rgc:audio SFZ test suite" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-download fa-fw"
										aria-hidden="true"></i>
										rgc:audio SFZ test suite</a>
									</li>
	<li class="nav-item">
										<a class="nav-link" href="https://github.com/sfz/opcode-suggestions/"
											title="Opcode suggestions" style="padding: 0.35rem 0.25rem">
										<i class="fas fa-lightbulb fa-fw"
										aria-hidden="true"></i>
										Opcode suggestions</a>
									</li>
	
								</ul>
							</div>
						</div>



					</aside>
				</div>
			</div>
			<hr>
			<footer>
				<p>
					This site is open source.
					<a href="https://github.com/sfzformat/sfzformat.github.io/edit/source/tutorials/envelope_generators.md">
					Improve this page</a>
				</p>
			</footer>

		</div>
		<script src="/assets/js/scripts.min.js"></script>		<script type="text/javascript" src="/assets/js/prettify/prettify.min.js"></script>
		<script type="text/javascript" src="/assets/js/prettify/lang-sfz.js"></script>
		<script>
			$(document).ready(function(){
			$('pre').addClass('prettyprint lang-sfz');
			prettyPrint();
			});
		</script>
		<script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js"></script>
		<script>
		$(document).on('click', '[data-toggle="lightbox"]', function(event) {
			event.preventDefault();
			$(this).ekkoLightbox({
				alwaysShowClose: true
			});
		});
		</script>


	</body>
</html>
